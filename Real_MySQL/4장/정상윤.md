# 4장 정리

## 4.1 MySQL 엔진 아키텍처

![image](https://user-images.githubusercontent.com/45227809/226368419-e8bd9496-2e91-49ac-8ceb-86fba84d98ea.png)


### MySQL 엔진

- 커넥션 핸들러, SQL Paser, Optimizer, 

- SQL 문장을 분석하고 최적화하는 역할을 수행

### 스토리지 엔진

- 실제 데이터를 디스크 스토리지에 저장, 디스크 스토리지로부터 데이터를 읽어오는 역할을 한다. 

### 핸들러 API 

- 핸들러 요청이란? 

    MySQL 엔진의 쿼리 실행기에서 데이터를 쓰거나 읽어야 할 때, 각 스토리지 엔진에 쓰기 또는 읽기를 요청하는 것.


### MySQL 스레딩 구조

- MySQL 서버는 프로세스 기반이 아니라 스레드 기반(https://velog.io/@raejoonee/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%99%80-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%B0%A8%EC%9D%B4)으로 작동한다.

- 스레드는 포그라운드/백그라운드 스레드로 구분 가능.

### 포그라운드 스레드 

- 최소한 MySQL 서버에 접속된 클라이언트 수만큼 존재하며, 주로 각 클라이언트 사용자가 요청하는 쿼리 문장을 처리.

- 커넥션이 종료되면, 스레드는 스레드 캐시로 되돌아간다.

- 이미 스레드 캐시에 일정 개수 이상의 대기중인 스레드가 있으면, 캐시에 넣지 않고 종료한다. 

- 최대 스레드 개수는 thread_cache_size 시스템 변수로 설정

- 데이터를 MySQL의 데이터 버퍼 혹은 캐시로부터 가져오며, 없다면 직접 디스크의 데이터나 인덱스 파일로부터 데이터를 읽어와서 처리.

### 백그라운드 스레드

- InnoDB의 경우 인서트 버퍼를 병합하는 스레드, 로그를 디스크로 기록하는 스레드, InnoDB 버퍼 풀의 데이터를 디스크에 기록하는 스레드, 데이터를 버퍼로 읽어오는 스레드, 잠금이나 데드락을 모니터링하는 스레드를 백그라운드로 처리.

- 로그 스레드와 쓰기 스레드가 가장 중요하다.



## 4.2 InnoDB 스토리지 엔진 아키텍처

## 4.3 MyISAM 스토리지 엔진 아키텍처

## 4.4 MySQL 로그 파일
